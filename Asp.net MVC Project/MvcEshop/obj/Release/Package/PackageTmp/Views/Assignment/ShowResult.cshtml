@model MvcEshop.ViewModels.Assignment.ShowResultViewModel

@{
    ViewBag.Title = Resources.DisplayNames.ShowResult;
    string strSpace = " ";
    ViewBag.LayoutType = "Grid";
    //ViewBag.LayoutType = "DataEntryForm";
    //ClassLibrary4.TextSpliter oFinalReport =
    //                    (ClassLibrary4.TextSpliter)System.Web.HttpContext.Current.Session["FinalReport"];

    //oFinalReport.currentPos++;
}

<div class="text-center" style="margin-bottom:20px; margin-top:15px;">
    <div>
        @using (Html.BeginForm())
        {
            @*<input type="submit" value=@Resources.DisplayNames.NextPage class="btn btn-success" />*@

            <a href="/Assignment/PublicDownload?fileNameInServer=@Model.WordFileNameInServer" class="btn btn-primary" role="button">
                <span class="glyphicon glyphicon-download KendoGridToolbarButtonIcon"></span>
                @Resources.DisplayNames.Download @strSpace @Resources.DisplayNames.OriginalDocument
            </a>
            <a href="/Assignment/DownloadPDFReport?assignmentFileId=@Model.AssignmentFileId" class="btn btn-primary" role="button">
                <span class="glyphicon glyphicon-download KendoGridToolbarButtonIcon"></span>
                @Resources.DisplayNames.Download @strSpace @Resources.DisplayNames.DocFindingReport
            </a>

            <a href="/Report/InitializationBeforeSend/@Model.AssignmentFileId" class="btn btn-primary" role="button">
                <span class="glyphicon glyphicon-send KendoGridToolbarButtonIcon"></span>
                @Resources.DisplayNames.Send @strSpace @Resources.DisplayNames.DocFindingReport
            </a>

            //paging buttons
            <div style="margin-top:10px;">
                <a href="/Assignment/GetFirstPage" class="btn btn-success" role="button">
                    <span class="glyphicon glyphicon-step-forward"></span>

                </a>

                <a href="/Assignment/GetPreviousPage" class="btn btn-success" role="button">
                    <span class="glyphicon glyphicon-chevron-right"></span>

                </a>



                <text>  @Model.TotalParts / @Model.CurrentPos</text>

                <a href="/Assignment/GetNextPage" class="btn btn-success" role="button">
                    <span class="glyphicon glyphicon-chevron-left"></span>

                </a>

                <a href="/Assignment/GetLastPage" class="btn btn-success" role="button">
                    <span class="glyphicon glyphicon-step-backward"></span>

                </a>

                <img id="ZoomIn" src="~/Content/Files/Icons/Zoom-In-icon.png" />
                <img id="ZoomOut" src="~/Content/Files/Icons/Zoom-Out-icon.png" />

            </div>

          

            @*//if the current role of the user is "Instructor".
                if (System.Convert.ToInt32(System.Web.HttpContext.Current.Session["RoleId"].ToString()) == 4)
                {
                    @Html.ActionLink("بازگشت به فهرست فایل های ارسالی",
                            MVC.Assignment.Inbox(
                            (System.Guid)System.Web.HttpContext.Current.Session["AssignmentId"])
                            , new { @class = "btn btn-primary" })


                }*@

            @*else
                {
                    @Html.ActionLink(string.Format("{0} {1}", Resources.DisplayNames.ReturnTo, ),
                            MVC.Assignment.Inbox(
                            MVC.User.GetUserIdByEmail(User.Identity.Name))
                            , new { @class = "btn btn-primary" })

                }*@


        }
    </div>
</div>
<div style="text-align:justify;">
    <div class="row" style="margin:0px;">
        <div class="col-md-2 col-sm-4 col-xs-5 col-lg-2">
            <div class="box">
                <div class="title">
                    لیست منابع همانندی
                </div>
                <div class="form">

                    @{int intCounter = 0;
                    Model.Results = Model.Results.OrderByDescending
                        (current => current.SimilarityPercentage)
                        .ToList();
                    }

                    @foreach (var result in Model.Results)
                    {
                        intCounter++;
                        string strCorrectedAddress = result.Address.Replace(@"///", @"//");

                        try
                        {



                            var uri = new Uri(strCorrectedAddress);
                            var host = uri.Host;


                            <div class="container box copyReference" style="margin-bottom:10px;">
                                <div class=@string.Format("b{0} container", result.SimilarityAmountOrder + 1)>
                                    <div class=@string.Format("col-md-6 b{0}", result.SimilarityAmountOrder + 1)>
                                        <a href=@result.Address
                                           class=@string.Format("b{0}",result.SimilarityAmountOrder+1)
                                           style="font-size:15pt; font-weight:bolder;">
                                            @intCounter
                                        </a>
                                    </div>
                                    @*<div class="col-md-8 container">
                                            <a href=@result.Address>@result.Address</a>
                                        </div>*@
                                    <div class="col-md-6" style="font-size:15pt; font-weight:bolder;">
                                        @result.SimilarityPercentage %
                                    </div>
                                </div>

                                <div class="text-center" style="font-size:15pt; font-weight:bolder;">

                                    <div class="container" style="margin-top:40px;">
                                        <div class="col-md-offset-3 col-md-5 col-lg-offset-3 col-lg-5 col-sm-offset-3 col-sm-5 col-xs-offset-3 col-xs-5"><a href="@result.Address" target="_blank" style="text-decoration:underline;">@*@host*@ @Resources.DisplayNames.CopyResource</a></div>
                                        <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2"><img src="~/Content/Files/Icons/favicon.ico" style="height:18px;" class="img-responsive" /></div>
                                    </div>
                                </div>

                            </div>
                        }
                        catch (Exception)
                        {


                        }
                    }

                </div>
            </div>
        </div>
        <div class="col-md-10 col-sm-8 col-xs-7 col-lg-10" style="padding:20px;">
            <div style="color:black; font-weight:bold; font-size:large; margin-bottom:30px;">@Resources.DisplayNames.SubmissionTitle:@MVC.Assignment.GetAssignmentFileById(Model.AssignmentFileId).SubmissionTitle</div>
            <div style="color:red; font-weight:bold; font-size:large; margin-bottom:30px;">درصد کل همانندی: @Model.TotalPercentage</div>
            <div id="divFinalReport" style="font-size:small;">@Html.Raw(Model.FinalReport)</div>
        </div>
    </div>
</div>

@section scripts{

    <script type="text/javascript">
        $(document).ready(function () {

            //$("#divFinalReport").animate({ 'zoom': 0.2 }, 400);

            $("#ZoomOut").click(function () {
                $("#divFinalReport").animate({ 'zoom': 0.2 }, 400);
            });

            $("#ZoomIn").click(function () {
                $("#divFinalReport").animate({ 'zoom': 1 }, 400);
            });

        });

    </script>
}